/* 
 * iotab.c - specification of IO port memory mapping
 *
 * Part of STonC (C) 2002 Laurent Vogel
 * Covered by the GPL version 2 or later; see COPYING for details
 */

#include <string.h> /* memset */
#include "iotab.h"
#include "utils.h"
 
#if 0
/* the following are placeholders */
B LOAD_B_MEM(void) {
  return 0;
}
void STORE_B_MEM(B v) {
  (void)v;
}
#else
#define LOAD_B_MEM 0
#define STORE_B_MEM 0
#endif

#define ROW(a,b,c) { 0x00 ## a, LOAD_B_ ## b, STORE_B_ ## c }

/* 
 * in the table below, MEM means that normal memory access 
 * should take place for this address; ffxxxx means that 
 * functions LOAD_B_ffxxxx or STORE_B_ffxxxx should be
 * called upon access to the address (first number).
 */
 
static const struct {
  UL address;
  B (*load_func)(void);
  void (*store_func)(B v);
} iotab[] = {
  ROW(ff7f30, MEM, ff7f30),
  ROW(ff7f31, MEM, ff7f31),
  ROW(ff8001, MEM, MEM),
  ROW(ff8200, ff8200, ff8200),
  ROW(ff8201, MEM, ff8201),
  ROW(ff8202, ff8202, ff8202),
  ROW(ff8203, MEM, ff8203),
  ROW(ff8204, MEM, MEM),
  ROW(ff8205, ff8205, MEM),
  ROW(ff8206, MEM, MEM),
  ROW(ff8207, ff8207, MEM),
  ROW(ff8208, MEM, MEM),
  ROW(ff8209, ff8209, MEM),
  ROW(ff820a, MEM, ff820a),
  ROW(ff820d, MEM, ff820d),
  ROW(ff8240, MEM, MEM),
  ROW(ff8241, MEM, MEM),
  ROW(ff8242, MEM, MEM),
  ROW(ff8243, MEM, MEM),
  ROW(ff8244, MEM, MEM),
  ROW(ff8245, MEM, MEM),
  ROW(ff8246, MEM, MEM),
  ROW(ff8247, MEM, MEM),
  ROW(ff8248, MEM, MEM),
  ROW(ff8249, MEM, MEM),
  ROW(ff824a, MEM, MEM),
  ROW(ff824b, MEM, MEM),
  ROW(ff824c, MEM, MEM),
  ROW(ff824d, MEM, MEM),
  ROW(ff824e, MEM, MEM),
  ROW(ff824f, MEM, MEM),
  ROW(ff8250, MEM, MEM),
  ROW(ff8251, MEM, MEM),
  ROW(ff8252, MEM, MEM),
  ROW(ff8253, MEM, MEM),
  ROW(ff8254, MEM, MEM),
  ROW(ff8255, MEM, MEM),
  ROW(ff8256, MEM, MEM),
  ROW(ff8257, MEM, MEM),
  ROW(ff8258, MEM, MEM),
  ROW(ff8259, MEM, MEM),
  ROW(ff825a, MEM, MEM),
  ROW(ff825b, MEM, MEM),
  ROW(ff825c, MEM, MEM),
  ROW(ff825d, MEM, MEM),
  ROW(ff825e, MEM, MEM),
  ROW(ff825f, MEM, MEM),
  ROW(ff8260, MEM, ff8260),
  ROW(ff8261, MEM, ff8261),
  ROW(ff8262, MEM, ff8262),
  ROW(ff8263, MEM, ff8263),
  ROW(ff8264, MEM, MEM),
  ROW(ff8265, MEM, MEM),
  ROW(ff8266, MEM, MEM),
  ROW(ff8267, MEM, MEM),
  ROW(ff8268, MEM, MEM),
  ROW(ff8269, MEM, MEM),
  ROW(ff826a, MEM, MEM),
  ROW(ff826b, MEM, MEM),
  ROW(ff826c, MEM, MEM),
  ROW(ff826d, MEM, MEM),
  ROW(ff826e, MEM, MEM),
  ROW(ff826f, MEM, MEM),
  ROW(ff8270, MEM, MEM),
  ROW(ff8271, MEM, MEM),
  ROW(ff8272, MEM, MEM),
  ROW(ff8273, MEM, MEM),
  ROW(ff8274, MEM, MEM),
  ROW(ff8275, MEM, MEM),
  ROW(ff8276, MEM, MEM),
  ROW(ff8277, MEM, MEM),
  ROW(ff8278, MEM, MEM),
  ROW(ff8279, MEM, MEM),
  ROW(ff827a, MEM, MEM),
  ROW(ff827b, MEM, MEM),
  ROW(ff827c, MEM, MEM),
  ROW(ff827d, MEM, MEM),
  ROW(ff827e, MEM, MEM),
  ROW(ff827f, MEM, MEM),
  ROW(ff8604, ff8604, ff8604),
  ROW(ff8605, ff8605, ff8605),
  ROW(ff8606, ff8606, ff8606),
  ROW(ff8607, ff8607, ff8607),
  ROW(ff8609, MEM, MEM),
  ROW(ff860b, MEM, MEM),
  ROW(ff860d, MEM, MEM),
  ROW(ff860e, MEM, MEM),
  ROW(ff860f, MEM, MEM),
  ROW(ff8800, ff8800, ff8800),
  ROW(ff8801, ff8801, ff8801),
  ROW(ff8802, ff8802, ff8802),
  ROW(ff8803, ff8803, ff8803),
  ROW(ff8804, ff8800, ff8800),
  ROW(ff8805, ff8801, ff8801),
  ROW(ff8806, ff8802, ff8802),
  ROW(ff8807, ff8803, ff8803),
  ROW(ff8808, ff8800, ff8800),
  ROW(ff8809, ff8801, ff8801),
  ROW(ff880a, ff8802, ff8802),
  ROW(ff880b, ff8803, ff8803),
  ROW(ff880c, ff8800, ff8800),
  ROW(ff880d, ff8801, ff8801),
  ROW(ff880e, ff8802, ff8802),
  ROW(ff880f, ff8803, ff8803),
  ROW(ff8810, ff8800, ff8800),
  ROW(ff8811, ff8801, ff8801),
  ROW(ff8812, ff8802, ff8802),
  ROW(ff8813, ff8803, ff8803),
  ROW(ff8814, ff8800, ff8800),
  ROW(ff8815, ff8801, ff8801),
  ROW(ff8816, ff8802, ff8802),
  ROW(ff8817, ff8803, ff8803),
  ROW(ff8818, ff8800, ff8800),
  ROW(ff8819, ff8801, ff8801),
  ROW(ff881a, ff8802, ff8802),
  ROW(ff881b, ff8803, ff8803),
  ROW(ff881c, ff8800, ff8800),
  ROW(ff881d, ff8801, ff8801),
  ROW(ff881e, ff8802, ff8802),
  ROW(ff881f, ff8803, ff8803),
  ROW(ff8820, ff8800, ff8800),
  ROW(ff8821, ff8801, ff8801),
  ROW(ff8822, ff8802, ff8802),
  ROW(ff8823, ff8803, ff8803),
  ROW(ff8824, ff8800, ff8800),
  ROW(ff8825, ff8801, ff8801),
  ROW(ff8826, ff8802, ff8802),
  ROW(ff8827, ff8803, ff8803),
  ROW(ff8828, ff8800, ff8800),
  ROW(ff8829, ff8801, ff8801),
  ROW(ff882a, ff8802, ff8802),
  ROW(ff882b, ff8803, ff8803),
  ROW(ff882c, ff8800, ff8800),
  ROW(ff882d, ff8801, ff8801),
  ROW(ff882e, ff8802, ff8802),
  ROW(ff882f, ff8803, ff8803),
  ROW(ff8830, ff8800, ff8800),
  ROW(ff8831, ff8801, ff8801),
  ROW(ff8832, ff8802, ff8802),
  ROW(ff8833, ff8803, ff8803),
  ROW(ff8834, ff8800, ff8800),
  ROW(ff8835, ff8801, ff8801),
  ROW(ff8836, ff8802, ff8802),
  ROW(ff8837, ff8803, ff8803),
  ROW(ff8838, ff8800, ff8800),
  ROW(ff8839, ff8801, ff8801),
  ROW(ff883a, ff8802, ff8802),
  ROW(ff883b, ff8803, ff8803),
  ROW(ff883c, ff8800, ff8800),
  ROW(ff883d, ff8801, ff8801),
  ROW(ff883e, ff8802, ff8802),
  ROW(ff883f, ff8803, ff8803),
  ROW(ff8840, ff8800, ff8800),
  ROW(ff8841, ff8801, ff8801),
  ROW(ff8842, ff8802, ff8802),
  ROW(ff8843, ff8803, ff8803),
  ROW(ff8844, ff8800, ff8800),
  ROW(ff8845, ff8801, ff8801),
  ROW(ff8846, ff8802, ff8802),
  ROW(ff8847, ff8803, ff8803),
  ROW(ff8848, ff8800, ff8800),
  ROW(ff8849, ff8801, ff8801),
  ROW(ff884a, ff8802, ff8802),
  ROW(ff884b, ff8803, ff8803),
  ROW(ff884c, ff8800, ff8800),
  ROW(ff884d, ff8801, ff8801),
  ROW(ff884e, ff8802, ff8802),
  ROW(ff884f, ff8803, ff8803),
  ROW(ff8850, ff8800, ff8800),
  ROW(ff8851, ff8801, ff8801),
  ROW(ff8852, ff8802, ff8802),
  ROW(ff8853, ff8803, ff8803),
  ROW(ff8854, ff8800, ff8800),
  ROW(ff8855, ff8801, ff8801),
  ROW(ff8856, ff8802, ff8802),
  ROW(ff8857, ff8803, ff8803),
  ROW(ff8858, ff8800, ff8800),
  ROW(ff8859, ff8801, ff8801),
  ROW(ff885a, ff8802, ff8802),
  ROW(ff885b, ff8803, ff8803),
  ROW(ff885c, ff8800, ff8800),
  ROW(ff885d, ff8801, ff8801),
  ROW(ff885e, ff8802, ff8802),
  ROW(ff885f, ff8803, ff8803),
  ROW(ff8860, ff8800, ff8800),
  ROW(ff8861, ff8801, ff8801),
  ROW(ff8862, ff8802, ff8802),
  ROW(ff8863, ff8803, ff8803),
  ROW(ff8864, ff8800, ff8800),
  ROW(ff8865, ff8801, ff8801),
  ROW(ff8866, ff8802, ff8802),
  ROW(ff8867, ff8803, ff8803),
  ROW(ff8868, ff8800, ff8800),
  ROW(ff8869, ff8801, ff8801),
  ROW(ff886a, ff8802, ff8802),
  ROW(ff886b, ff8803, ff8803),
  ROW(ff886c, ff8800, ff8800),
  ROW(ff886d, ff8801, ff8801),
  ROW(ff886e, ff8802, ff8802),
  ROW(ff886f, ff8803, ff8803),
  ROW(ff8870, ff8800, ff8800),
  ROW(ff8871, ff8801, ff8801),
  ROW(ff8872, ff8802, ff8802),
  ROW(ff8873, ff8803, ff8803),
  ROW(ff8874, ff8800, ff8800),
  ROW(ff8875, ff8801, ff8801),
  ROW(ff8876, ff8802, ff8802),
  ROW(ff8877, ff8803, ff8803),
  ROW(ff8878, ff8800, ff8800),
  ROW(ff8879, ff8801, ff8801),
  ROW(ff887a, ff8802, ff8802),
  ROW(ff887b, ff8803, ff8803),
  ROW(ff887c, ff8800, ff8800),
  ROW(ff887d, ff8801, ff8801),
  ROW(ff887e, ff8802, ff8802),
  ROW(ff887f, ff8803, ff8803),
  ROW(ff8880, ff8800, ff8800),
  ROW(ff8881, ff8801, ff8801),
  ROW(ff8882, ff8802, ff8802),
  ROW(ff8883, ff8803, ff8803),
  ROW(ff8884, ff8800, ff8800),
  ROW(ff8885, ff8801, ff8801),
  ROW(ff8886, ff8802, ff8802),
  ROW(ff8887, ff8803, ff8803),
  ROW(ff8888, ff8800, ff8800),
  ROW(ff8889, ff8801, ff8801),
  ROW(ff888a, ff8802, ff8802),
  ROW(ff888b, ff8803, ff8803),
  ROW(ff888c, ff8800, ff8800),
  ROW(ff888d, ff8801, ff8801),
  ROW(ff888e, ff8802, ff8802),
  ROW(ff888f, ff8803, ff8803),
  ROW(ff8890, ff8800, ff8800),
  ROW(ff8891, ff8801, ff8801),
  ROW(ff8892, ff8802, ff8802),
  ROW(ff8893, ff8803, ff8803),
  ROW(ff8894, ff8800, ff8800),
  ROW(ff8895, ff8801, ff8801),
  ROW(ff8896, ff8802, ff8802),
  ROW(ff8897, ff8803, ff8803),
  ROW(ff8898, ff8800, ff8800),
  ROW(ff8899, ff8801, ff8801),
  ROW(ff889a, ff8802, ff8802),
  ROW(ff889b, ff8803, ff8803),
  ROW(ff889c, ff8800, ff8800),
  ROW(ff889d, ff8801, ff8801),
  ROW(ff889e, ff8802, ff8802),
  ROW(ff889f, ff8803, ff8803),
  ROW(ff88a0, ff8800, ff8800),
  ROW(ff88a1, ff8801, ff8801),
  ROW(ff88a2, ff8802, ff8802),
  ROW(ff88a3, ff8803, ff8803),
  ROW(ff88a4, ff8800, ff8800),
  ROW(ff88a5, ff8801, ff8801),
  ROW(ff88a6, ff8802, ff8802),
  ROW(ff88a7, ff8803, ff8803),
  ROW(ff88a8, ff8800, ff8800),
  ROW(ff88a9, ff8801, ff8801),
  ROW(ff88aa, ff8802, ff8802),
  ROW(ff88ab, ff8803, ff8803),
  ROW(ff88ac, ff8800, ff8800),
  ROW(ff88ad, ff8801, ff8801),
  ROW(ff88ae, ff8802, ff8802),
  ROW(ff88af, ff8803, ff8803),
  ROW(ff88b0, ff8800, ff8800),
  ROW(ff88b1, ff8801, ff8801),
  ROW(ff88b2, ff8802, ff8802),
  ROW(ff88b3, ff8803, ff8803),
  ROW(ff88b4, ff8800, ff8800),
  ROW(ff88b5, ff8801, ff8801),
  ROW(ff88b6, ff8802, ff8802),
  ROW(ff88b7, ff8803, ff8803),
  ROW(ff88b8, ff8800, ff8800),
  ROW(ff88b9, ff8801, ff8801),
  ROW(ff88ba, ff8802, ff8802),
  ROW(ff88bb, ff8803, ff8803),
  ROW(ff88bc, ff8800, ff8800),
  ROW(ff88bd, ff8801, ff8801),
  ROW(ff88be, ff8802, ff8802),
  ROW(ff88bf, ff8803, ff8803),
  ROW(ff88c0, ff8800, ff8800),
  ROW(ff88c1, ff8801, ff8801),
  ROW(ff88c2, ff8802, ff8802),
  ROW(ff88c3, ff8803, ff8803),
  ROW(ff88c4, ff8800, ff8800),
  ROW(ff88c5, ff8801, ff8801),
  ROW(ff88c6, ff8802, ff8802),
  ROW(ff88c7, ff8803, ff8803),
  ROW(ff88c8, ff8800, ff8800),
  ROW(ff88c9, ff8801, ff8801),
  ROW(ff88ca, ff8802, ff8802),
  ROW(ff88cb, ff8803, ff8803),
  ROW(ff88cc, ff8800, ff8800),
  ROW(ff88cd, ff8801, ff8801),
  ROW(ff88ce, ff8802, ff8802),
  ROW(ff88cf, ff8803, ff8803),
  ROW(ff88d0, ff8800, ff8800),
  ROW(ff88d1, ff8801, ff8801),
  ROW(ff88d2, ff8802, ff8802),
  ROW(ff88d3, ff8803, ff8803),
  ROW(ff88d4, ff8800, ff8800),
  ROW(ff88d5, ff8801, ff8801),
  ROW(ff88d6, ff8802, ff8802),
  ROW(ff88d7, ff8803, ff8803),
  ROW(ff88d8, ff8800, ff8800),
  ROW(ff88d9, ff8801, ff8801),
  ROW(ff88da, ff8802, ff8802),
  ROW(ff88db, ff8803, ff8803),
  ROW(ff88dc, ff8800, ff8800),
  ROW(ff88dd, ff8801, ff8801),
  ROW(ff88de, ff8802, ff8802),
  ROW(ff88df, ff8803, ff8803),
  ROW(ff88e0, ff8800, ff8800),
  ROW(ff88e1, ff8801, ff8801),
  ROW(ff88e2, ff8802, ff8802),
  ROW(ff88e3, ff8803, ff8803),
  ROW(ff88e4, ff8800, ff8800),
  ROW(ff88e5, ff8801, ff8801),
  ROW(ff88e6, ff8802, ff8802),
  ROW(ff88e7, ff8803, ff8803),
  ROW(ff88e8, ff8800, ff8800),
  ROW(ff88e9, ff8801, ff8801),
  ROW(ff88ea, ff8802, ff8802),
  ROW(ff88eb, ff8803, ff8803),
  ROW(ff88ec, ff8800, ff8800),
  ROW(ff88ed, ff8801, ff8801),
  ROW(ff88ee, ff8802, ff8802),
  ROW(ff88ef, ff8803, ff8803),
  ROW(ff88f0, ff8800, ff8800),
  ROW(ff88f1, ff8801, ff8801),
  ROW(ff88f2, ff8802, ff8802),
  ROW(ff88f3, ff8803, ff8803),
  ROW(ff88f4, ff8800, ff8800),
  ROW(ff88f5, ff8801, ff8801),
  ROW(ff88f6, ff8802, ff8802),
  ROW(ff88f7, ff8803, ff8803),
  ROW(ff88f8, ff8800, ff8800),
  ROW(ff88f9, ff8801, ff8801),
  ROW(ff88fa, ff8802, ff8802),
  ROW(ff88fb, ff8803, ff8803),
  ROW(ff88fc, ff8800, ff8800),
  ROW(ff88fd, ff8801, ff8801),
  ROW(ff88fe, ff8802, ff8802),
  ROW(ff88ff, ff8803, ff8803),
  ROW(ff8900, MEM, MEM),
  ROW(ff8901, MEM, MEM),
  ROW(ff8902, MEM, MEM),
  ROW(ff8903, MEM, MEM),
  ROW(ff8904, MEM, MEM),
  ROW(ff8905, MEM, MEM),
  ROW(ff8906, MEM, MEM),
  ROW(ff8907, MEM, MEM),
  ROW(ff8908, MEM, MEM),
  ROW(ff8909, MEM, MEM),
  ROW(ff890a, MEM, MEM),
  ROW(ff890b, MEM, MEM),
  ROW(ff890c, MEM, MEM),
  ROW(ff890d, MEM, MEM),
  ROW(ff890e, MEM, MEM),
  ROW(ff890f, MEM, MEM),
  ROW(ff8910, MEM, MEM),
  ROW(ff8911, MEM, MEM),
  ROW(ff8912, MEM, MEM),
  ROW(ff8913, MEM, MEM),
  ROW(ff8920, ff8920, MEM),
  ROW(ff8921, ff8921, MEM),
  ROW(ff8922, ff8922, MEM),
  ROW(ff8923, ff8923, MEM),
  ROW(ff8924, ff8924, MEM),
  ROW(ff8925, ff8925, MEM),
  ROW(ff8a00, MEM, MEM),
  ROW(ff8a01, MEM, MEM),
  ROW(ff8a02, MEM, MEM),
  ROW(ff8a03, MEM, MEM),
  ROW(ff8a04, MEM, MEM),
  ROW(ff8a05, MEM, MEM),
  ROW(ff8a06, MEM, MEM),
  ROW(ff8a07, MEM, MEM),
  ROW(ff8a08, MEM, MEM),
  ROW(ff8a09, MEM, MEM),
  ROW(ff8a0a, MEM, MEM),
  ROW(ff8a0b, MEM, MEM),
  ROW(ff8a0c, MEM, MEM),
  ROW(ff8a0d, MEM, MEM),
  ROW(ff8a0e, MEM, MEM),
  ROW(ff8a0f, MEM, MEM),
  ROW(ff8a10, MEM, MEM),
  ROW(ff8a11, MEM, MEM),
  ROW(ff8a12, MEM, MEM),
  ROW(ff8a13, MEM, MEM),
  ROW(ff8a14, MEM, MEM),
  ROW(ff8a15, MEM, MEM),
  ROW(ff8a16, MEM, MEM),
  ROW(ff8a17, MEM, MEM),
  ROW(ff8a18, MEM, MEM),
  ROW(ff8a19, MEM, MEM),
  ROW(ff8a1a, MEM, MEM),
  ROW(ff8a1b, MEM, MEM),
  ROW(ff8a1c, MEM, MEM),
  ROW(ff8a1d, MEM, MEM),
  ROW(ff8a1e, MEM, MEM),
  ROW(ff8a1f, MEM, MEM),
  ROW(ff8a20, MEM, MEM),
  ROW(ff8a21, MEM, MEM),
  ROW(ff8a22, MEM, MEM),
  ROW(ff8a23, MEM, MEM),
  ROW(ff8a24, MEM, MEM),
  ROW(ff8a25, MEM, MEM),
  ROW(ff8a26, MEM, MEM),
  ROW(ff8a27, MEM, MEM),
  ROW(ff8a28, ff8a28, ff8a28),
  ROW(ff8a29, ff8a29, ff8a29),
  ROW(ff8a2a, ff8a2a, ff8a2a),
  ROW(ff8a2b, ff8a2b, ff8a2b),
  ROW(ff8a2c, ff8a2c, ff8a2c),
  ROW(ff8a2d, ff8a2d, ff8a2d),
  ROW(ff8a2e, MEM, MEM),
  ROW(ff8a2f, MEM, MEM),
  ROW(ff8a30, MEM, ff7f30),
  ROW(ff8a31, MEM, ff7f31),
  ROW(ff8a32, ff8a32, ff8a32),
  ROW(ff8a33, ff8a33, ff8a33),
  ROW(ff8a34, ff8a34, ff8a34),
  ROW(ff8a35, ff8a35, ff8a35),
  ROW(ff8a36, ff8a36, ff8a36),
  ROW(ff8a37, ff8a37, ff8a37),
  ROW(ff8a38, ff8a38, ff8a38),
  ROW(ff8a39, ff8a39, ff8a39),
  ROW(ff8a3a, ff8a3a, ff8a3a),
  ROW(ff8a3b, ff8a3b, ff8a3b),
  ROW(ff8a3c, ff8a3c, ff8a3c),
  ROW(ff8a3d, ff8a3d, ff8a3d),
  ROW(ff9200, MEM, MEM),
  ROW(ff9201, MEM, MEM),
  ROW(ff9202, MEM, MEM),
  ROW(ff9203, MEM, MEM),
  ROW(fffa01, fffa01, fffa01),
  ROW(fffa02, MEM, MEM),
  ROW(fffa03, fffa03, fffa03),
  ROW(fffa04, MEM, MEM),
  ROW(fffa05, fffa05, fffa05),
  ROW(fffa06, MEM, MEM),
  ROW(fffa07, fffa07, fffa07),
  ROW(fffa08, MEM, MEM),
  ROW(fffa09, fffa09, fffa09),
  ROW(fffa0a, MEM, MEM),
  ROW(fffa0b, fffa0b, fffa0b),
  ROW(fffa0c, MEM, MEM),
  ROW(fffa0d, fffa0d, fffa0d),
  ROW(fffa0e, MEM, MEM),
  ROW(fffa0f, fffa0f, fffa0f),
  ROW(fffa10, MEM, MEM),
  ROW(fffa11, fffa11, fffa11),
  ROW(fffa12, MEM, MEM),
  ROW(fffa13, fffa13, fffa13),
  ROW(fffa14, MEM, MEM),
  ROW(fffa15, fffa15, fffa15),
  ROW(fffa16, MEM, MEM),
  ROW(fffa17, fffa17, fffa17),
  ROW(fffa18, MEM, MEM),
  ROW(fffa19, fffa19, fffa19),
  ROW(fffa1a, MEM, MEM),
  ROW(fffa1b, fffa1b, fffa1b),
  ROW(fffa1c, MEM, MEM),
  ROW(fffa1d, fffa1d, fffa1d),
  ROW(fffa1e, MEM, MEM),
  ROW(fffa1f, fffa1f, fffa1f),
  ROW(fffa20, MEM, MEM),
  ROW(fffa21, fffa21, fffa21),
  ROW(fffa22, MEM, MEM),
  ROW(fffa23, fffa23, fffa23),
  ROW(fffa24, MEM, MEM),
  ROW(fffa25, fffa25, fffa25),
  ROW(fffa26, MEM, MEM),
  ROW(fffa27, fffa27, fffa27),
  ROW(fffa28, MEM, MEM),
  ROW(fffa29, fffa29, fffa29),
  ROW(fffa2a, MEM, MEM),
  ROW(fffa2b, fffa2b, fffa2b),
  ROW(fffa2c, MEM, MEM),
  ROW(fffa2d, fffa2d, fffa2d),
  ROW(fffa2e, MEM, MEM),
  ROW(fffa2f, fffa2f, fffa2f),
  ROW(fffa30, MEM, MEM),
  ROW(fffa31, fffa31, fffa31),
  ROW(fffa32, MEM, MEM),
  ROW(fffc00, fffc00, fffc00),
  ROW(fffc02, fffc02, fffc02),
  ROW(fffc04, fffc04, fffc04),
  ROW(fffc06, fffc06, fffc06),
  ROW(fffc20, fffc20, fffc20),
  ROW(fffc21, fffc21, fffc21),
  ROW(fffc22, fffc22, fffc22),
  ROW(fffc23, fffc23, fffc23),
  ROW(fffc24, fffc24, fffc24),
  ROW(fffc25, fffc25, fffc25),
  ROW(fffc26, fffc26, fffc26),
  ROW(fffc27, fffc27, fffc27),
  ROW(fffc28, fffc28, fffc28),
  ROW(fffc29, fffc29, fffc29),
  ROW(fffc2a, fffc2a, fffc2a),
  ROW(fffc2b, fffc2b, fffc2b),
  ROW(fffc2c, fffc2c, fffc2c),
  ROW(fffc2d, fffc2d, fffc2d),
  ROW(fffc2e, fffc2e, fffc2e),
  ROW(fffc2f, fffc2f, fffc2f),
  ROW(fffc30, fffc30, fffc30),
  ROW(fffc31, fffc31, fffc31),
  ROW(fffc32, fffc32, fffc32),
  ROW(fffc33, fffc33, fffc33),
  ROW(fffc34, fffc34, fffc34),
  ROW(fffc35, fffc35, fffc35),
  ROW(fffc36, fffc36, fffc36),
  ROW(fffc37, fffc37, fffc37),
  ROW(fffc38, fffc38, fffc38),
  ROW(fffc39, fffc39, fffc39),
  ROW(fffc3a, fffc3a, fffc3a),
  ROW(fffc3b, fffc3b, fffc3b),
  ROW(fffc3c, fffc3c, fffc3c),
  ROW(fffc3d, fffc3d, fffc3d),
  ROW(fffc3e, fffc3e, fffc3e),
  ROW(fffc3f, fffc3f, fffc3f),
};

#define N ((int)(sizeof iotab / sizeof * iotab))

B (* IOTAB_funcs_LOAD[254])(void);
void (* IOTAB_funcs_STORE[254])(B);
UB IOTAB_flags_LOAD[0x10000];
UB IOTAB_flags_STORE[0x10000];

void init_iotab(void)
{
  int i, j;
  unsigned int a;
  int nfuncs_load = 0;
  int nfuncs_store = 0;
  
  memset(IOTAB_flags_LOAD, 0, 0x10000);
  memset(IOTAB_flags_STORE, 0, 0x10000);

  for(i = 0 ; i < N ; i++) {
    a = iotab[i].address - 0xff0000;
    assert(a < 0x10000);
    if(iotab[i].load_func == LOAD_B_MEM) {
      IOTAB_flags_LOAD[a] = 1;
    } else {
      for(j = 0 ; j < nfuncs_load ; j++) {
        if(IOTAB_funcs_LOAD[j] == iotab[i].load_func) break;
      }
      IOTAB_flags_LOAD[a] = j + 2;
      if(j >= nfuncs_load) {
        IOTAB_funcs_LOAD[nfuncs_load++] = iotab[i].load_func;
      }
    } 
    if(iotab[i].store_func == STORE_B_MEM) {
      IOTAB_flags_STORE[a] = 1;
    } else {
      for(j = 0 ; j < nfuncs_store ; j++) {
        if(IOTAB_funcs_STORE[j] == iotab[i].store_func) break;
      }
      IOTAB_flags_STORE[a] = j + 2;
      if(j >= nfuncs_store) {
        IOTAB_funcs_STORE[nfuncs_store++] = iotab[i].store_func;
      }
    }
  }
  assert(nfuncs_load < 254);
  assert(nfuncs_store < 254);
}

